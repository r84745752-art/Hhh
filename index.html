<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Bot - HTML Test Generator</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 20px;
        }
        
        .panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .input-panel {
            flex: 1;
        }
        
        .output-panel {
            flex: 1;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        h2 {
            margin-bottom: 15px;
            color: #2d3748;
        }
        
        textarea {
            width: 100%;
            height: 400px;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #ddd;
            font-family: monospace;
            resize: vertical;
            margin-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            display: block;
            width: 100%;
            margin-top: 10px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }
        
        .preview {
            background: #f7fafc;
            border-radius: 10px;
            padding: 15px;
            height: 400px;
            overflow-y: auto;
            margin-bottom: 15px;
            border: 1px solid #e2e8f0;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #1cc88a 0%, #17a673 100%);
        }
        
        .download-btn:hover {
            background: linear-gradient(135deg, #17a673 0%, #138b63 100%);
        }
        
        .instructions {
            background: #ebf8ff;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #3182ce;
        }
        
        .instructions h3 {
            color: #2c5282;
            margin-bottom: 10px;
        }
        
        .instructions ul {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .example {
            background: #f0fff4;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-family: monospace;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="panel input-panel">
            <h1>Quiz Bot - HTML Test Generator</h1>
            
            <div class="form-group">
                <label for="testTitle">Test Title</label>
                <input type="text" id="testTitle" placeholder="e.g., VDO Test - 08 (Agriculture Science)" value="VDO Test - 08 (Agriculture Science)">
            </div>
            
            <div class="form-group">
                <label for="testCategory">Test Category</label>
                <input type="text" id="testCategory" placeholder="e.g., VDO-2025" value="VDO-2025">
            </div>
            
            <div class="form-group">
                <label for="totalQuestions">Total Questions</label>
                <input type="number" id="totalQuestions" value="100" min="1">
            </div>
            
            <div class="form-group">
                <label for="totalMarks">Total Marks</label>
                <input type="number" id="totalMarks" value="100" min="1">
            </div>
            
            <div class="form-group">
                <label for="duration">Duration (minutes)</label>
                <input type="number" id="duration" value="120" min="1">
            </div>
            
            <div class="form-group">
                <label for="questionsText">Questions (in text format)</label>
                <textarea id="questionsText" placeholder="Paste your questions here in the format:
Q1. Question text?
A) Option 1
B) Option 2
C) Option 3
D) Option 4
Correct: A
Solution: Explanation of the answer

Q2. Next question?
..."></textarea>
            </div>
            
            <button id="generateBtn">Generate HTML Test</button>
            
            <div class="instructions">
                <h3>How to format your questions:</h3>
                <ul>
                    <li>Start each question with "Q" followed by a number and a period</li>
                    <li>List options with A), B), C), D)</li>
                    <li>Specify correct answer with "Correct: " followed by A, B, C, or D</li>
                    <li>Add solution with "Solution: " followed by explanation</li>
                    <li>Separate questions with a blank line</li>
                </ul>
                <div class="example">
                    Q1. What is the capital of France?<br>
                    A) London<br>
                    B) Berlin<br>
                    C) Paris<br>
                    D) Madrid<br>
                    Correct: C<br>
                    Solution: Paris is the capital and most populous city of France.
                </div>
            </div>
        </div>
        
        <div class="panel output-panel">
            <h2>Generated HTML Test Preview</h2>
            <div class="preview" id="preview">
                <p>Your generated test will appear here...</p>
            </div>
            <button id="downloadBtn" class="download-btn" disabled>Download HTML File</button>
            <button id="copyBtn" disabled>Copy HTML Code</button>
        </div>
    </div>

    <script>
        document.getElementById('generateBtn').addEventListener('click', generateTest);
        document.getElementById('downloadBtn').addEventListener('click', downloadHTML);
        document.getElementById('copyBtn').addEventListener('click', copyHTML);
        
        function generateTest() {
            const questionsText = document.getElementById('questionsText').value;
            const testTitle = document.getElementById('testTitle').value;
            const testCategory = document.getElementById('testCategory').value;
            const totalQuestions = document.getElementById('totalQuestions').value;
            const totalMarks = document.getElementById('totalMarks').value;
            const duration = document.getElementById('duration').value;
            
            const questions = parseQuestions(questionsText);
            
            if (questions.length === 0) {
                alert('No valid questions found. Please check your formatting.');
                return;
            }
            
            const htmlCode = createHTMLTest(questions, {
                title: testTitle,
                category: testCategory,
                totalQuestions: parseInt(totalQuestions),
                totalMarks: parseInt(totalMarks),
                duration: parseInt(duration)
            });
            
            document.getElementById('preview').innerHTML = `<pre>${htmlCode}</pre>`;
            document.getElementById('downloadBtn').disabled = false;
            document.getElementById('copyBtn').disabled = false;
            
            // Store the HTML code for download/copy
            document.getElementById('preview').dataset.htmlCode = htmlCode;
        }
        
        function parseQuestions(text) {
            const questions = [];
            const lines = text.split('\n');
            let currentQuestion = null;
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (line.startsWith('Q') && line.includes('.')) {
                    // New question
                    if (currentQuestion) {
                        questions.push(currentQuestion);
                    }
                    
                    currentQuestion = {
                        text: line.substring(line.indexOf('.') + 1).trim(),
                        options: [],
                        correct_option: '',
                        solution: ''
                    };
                } else if (line.match(/^[A-D]\)/)) {
                    // Option
                    if (currentQuestion) {
                        currentQuestion.options.push(line.substring(3).trim());
                    }
                } else if (line.startsWith('Correct:')) {
                    // Correct answer
                    if (currentQuestion) {
                        const correctLetter = line.substring(8).trim();
                        // Convert A,B,C,D to 1,2,3,4
                        currentQuestion.correct_option = (correctLetter.charCodeAt(0) - 64).toString();
                    }
                } else if (line.startsWith('Solution:')) {
                    // Solution
                    if (currentQuestion) {
                        currentQuestion.solution = line.substring(9).trim();
                        
                        // Check if solution continues on next lines
                        let j = i + 1;
                        while (j < lines.length && lines[j].trim() && 
                               !lines[j].trim().startsWith('Q') && 
                               !lines[j].trim().match(/^[A-D]\)/) && 
                               !lines[j].trim().startsWith('Correct:')) {
                            currentQuestion.solution += ' ' + lines[j].trim();
                            j++;
                            i = j - 1;
                        }
                    }
                }
            }
            
            // Add the last question
            if (currentQuestion) {
                questions.push(currentQuestion);
            }
            
            return questions;
        }
        
        function createHTMLTest(questions, examInfo) {
            // Generate unique IDs for questions
            const questionsWithIds = questions.map((q, i) => ({
                ...q,
                id: 318758 + i
            }));
            
            return `<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>${examInfo.title} - ${examInfo.category}</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400..900&family=Eczar:wght@400..800&family=Orbitron:wght@400..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>
<style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 20px;
        }
        
        .welcome-title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .test-name-display {
            font-size: 1.8rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .category-display {
            font-size: 1.2rem;
            color: #718096;
            margin-bottom: 20px;
        }
        
        .provider-info {
            font-size: 1.1rem;
            color: #718096;
            margin-bottom: 30px;
            font-style: italic;
        }
        
        .quiz-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(240, 147, 251, 0.3);
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .start-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        
        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.6);
        }
        
        /* Quiz Interface */
        .quiz-interface {
            display: none;
        }
        
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        h1 {
            font-size: 1.8rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .quiz-info {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .info-item {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            padding: 12px 20px;
            border-radius: 25px;
            margin: 5px;
            font-weight: 600;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }
        
        .timer-container {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .timer {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 1.1rem;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .timer i {
            margin-right: 8px;
        }
        
        .progress-container {
            margin: 20px 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            height: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }
        
        .question-count {
            text-align: right;
            font-size: 1rem;
            color: #4a5568;
            font-weight: 600;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            float: right;
        }
        
        .question {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            clear: both;
        }
        
        .question-text {
            font-size: 1.3rem;
            font-weight: 500;
            color: #2d3748;
            margin-bottom: 25px;
            line-height: 1.6;
            font-family: 'Eczar', serif;
        }
        
        .options {
            list-style: none;
        }
        
        .option {
            padding: 18px 25px;
            margin-bottom: 15px;
            background: rgba(247, 250, 252, 0.8);
            border: 2px solid rgba(226, 232, 240, 0.5);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            overflow: hidden;
            font-family: 'Poppins', sans-serif;
        }
        
        .option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.5s;
        }
        
        .option:hover::before {
            left: 100%;
        }
        
        .option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-color: #667eea;
        }
        
        .option.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }
        
        .option.correct {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%) !important;
            color: white !important;
            border-color: #48bb78 !important;
        }
        
        .option.incorrect {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%) !important;
            color: white !important;
            border-color: #f56565 !important;
        }
        
        .option.skipped {
            background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%) !important;
            color: white !important;
            border-color: #ed8936 !important;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 120px;
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        button:disabled {
            background: #b0b0b0 !important;
            cursor: not-allowed;
            transform: none;
            opacity: 0.6;
        }
        
        #prev-btn {
            background: linear-gradient(135deg, #a0aec0 0%, #718096 100%);
            color: white;
        }
        
        #next-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #1cc88a 0%, #17a673 100%) !important;
            color: white;
            box-shadow: 0 5px 15px rgba(28, 200, 138, 0.4);
        }
        
        .submit-btn:hover {
            background: linear-gradient(135deg, #17a673 0%, #138b63 100%) !important;
        }
        
        /* Results */
        .result-container {
            text-align: center;
            padding: 40px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .result-container h2 {
            font-size: 2rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 20px;
        }
        
        .score {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 20px 0;
        }
        
        .score-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
            text-align: left;
        }
        
        .breakdown-item {
            padding: 20px;
            border-radius: 15px;
            color: white;
            font-weight: 600;
        }
        
        .breakdown-item.correct {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }
        
        .breakdown-item.incorrect {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
        }
        
        .breakdown-item.skipped {
            background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
        }
        
        .breakdown-number {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .breakdown-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .performance-message {
            font-size: 1.2rem;
            color: #4a5568;
            margin: 20px 0;
            font-weight: 500;
        }
        
        .detailed-results {
            text-align: left;
            margin-top: 30px;
        }
        
        .detailed-results h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }
        
        .result-question {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #667eea;
        }
        
        .result-question-text {
            font-weight: 600;
            margin-bottom: 15px;
            color: #2d3748;
        }
        
        .result-status {
            float: right;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-correct {
            background: #48bb78;
            color: white;
        }
        
        .status-incorrect {
            background: #f56565;
            color: white;
        }
        
        .status-skipped {
            background: #ed8936;
            color: white;
        }
        
        .answer-section {
            margin: 10px 0;
            padding: 10px;
            border-radius: 8px;
        }
        
        .user-answer {
            background: #e2e8f0;
            color: #2d3748;
        }
        
        .correct-answer {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .solution {
            background: #ebf8ff;
            color: #2c5282;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 3px solid #3182ce;
            text-align: left;
        }
        
        .restart-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        
        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .welcome-title {
                font-size: 2rem;
            }
            
            .test-name-display {
                font-size: 1.4rem;
            }
            
            .quiz-info {
                flex-direction: column;
                align-items: center;
            }
            
            .navigation {
                flex-direction: column;
            }
            
            .score-breakdown {
                grid-template-columns: 1fr;
            }
            
            header {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .question {
                padding: 20px;
            }
            
            button {
                padding: 12px 20px;
            }
        }
    </style>
</head>
<body>
<div class="container">
<!-- Welcome Screen -->
<div class="welcome-screen" id="welcome-screen">
<h1 class="welcome-title">Welcome to Quiz</h1>
<h2 class="test-name-display">${examInfo.title}</h2>
<p class="category-display">${examInfo.category}</p>
<div style="margin-bottom: 15px;"><a href="https://t.me/DecodeSikar" style="display:inline-block; padding:12px 25px; background:linear-gradient(135deg,#0088cc,#005f99); color:white; border-radius:25px; font-weight:600; text-decoration:none;" target="_blank">🚀 Join Telegram</a></div>
<div class="quiz-stats">
<div class="stat-card">
<div class="stat-value">${examInfo.totalQuestions}</div>
<div class="stat-label">Total Questions</div>
</div>
<div class="stat-card">
<div class="stat-value">${examInfo.totalMarks}</div>
<div class="stat-label">Total Marks</div>
</div>
<div class="stat-card">
<div class="stat-value">${examInfo.duration}</div>
<div class="stat-label">Minutes</div>
</div>
</div>
<button class="start-btn" onclick="startQuiz()">
<i class="fas fa-play"></i> Start Quiz
            </button>
</div>
<!-- Quiz Interface -->
<div class="quiz-interface" id="quiz-interface">
<header>
<h1>${examInfo.title}</h1>
<p style="text-align: center; color: #718096; margin-top: 5px;">${examInfo.category}</p>
<div class="quiz-info">
<div class="info-item">Total Questions: ${examInfo.totalQuestions}</div>
<div class="info-item">Total Marks: ${examInfo.totalMarks}</div>
<div class="info-item">Time: ${examInfo.duration} Minutes</div>
</div>
</header>
<div class="timer-container">
<div class="timer" id="timer">
<i class="fas fa-clock"></i>
<span id="time-display">Loading...</span>
</div>
</div>
<!-- Top Submit Button -->
<div style="text-align: center; margin: 20px 0;">
<button class="submit-btn" id="top-submit-btn" onclick="submitQuiz()" style="display: inline-block;">
<i class="fas fa-check"></i> Submit Quiz
                </button>
</div>
<div class="progress-container">
<div class="progress-bar" id="progress-bar"></div>
</div>
<div class="question-count" id="question-count">Question 1/${examInfo.totalQuestions}</div>
<div id="quiz-content">
<!-- Questions will be inserted here by JavaScript -->
</div>
<div class="navigation">
<button disabled="" id="prev-btn" onclick="prevQuestion()">
<i class="fas fa-chevron-left"></i> Previous / पिछला
                </button>
<button id="next-btn" onclick="nextQuestion()">
                    Next / अगला <i class="fas fa-chevron-right"></i>
</button>
</div>
<div style="text-align: center; margin-top: 20px;">
<button class="submit-btn" id="submit-btn" onclick="submitQuiz()" style="display: none;">
<i class="fas fa-check"></i> Submit Quiz / परीक्षा समाप्त करें
                </button>
</div>
</div>
<div class="result-container" id="result-container" style="display: none;">
<h2>Your Results</h2>
<div class="score" id="score">0/${examInfo.totalMarks}</div>
<p class="performance-message" id="result-message"></p>
<div class="score-breakdown" id="score-breakdown">
<div class="breakdown-item correct">
<div class="breakdown-number" id="correct-count">0</div>
<div class="breakdown-label">Correct</div>
</div>
<div class="breakdown-item incorrect">
<div class="breakdown-number" id="incorrect-count">0</div>
<div class="breakdown-label">Incorrect</div>
</div>
<div class="breakdown-item skipped">
<div class="breakdown-number" id="skipped-count">0</div>
<div class="breakdown-label">Skipped</div>
</div>
</div>
<div class="detailed-results" id="detailed-results">
<h3>Detailed Results with Solutions</h3>
<div id="detailed-questions"></div>
</div>
<button class="restart-btn" onclick="restartQuiz()">
<i class="fas fa-redo"></i> Take Quiz Again
            </button>
</div>
</div>
<script>
       // Quiz data
        const questions = ${JSON.stringify(questionsWithIds, null, 12)};

        const examInfo = {
            "test_id": 3707,
            "test_duration": "${examInfo.duration}",
            "test_total_question": ${examInfo.totalQuestions},
            "test_total_marks": ${examInfo.totalMarks},
            "test_title": "${examInfo.title}"
        };

        // Quiz state variables
        let currentQuestionIndex = 0;
        let userAnswers = new Array(questions.length).fill(null);
        let timer;
        let timeLeft = parseInt(examInfo.test_duration) * 60; // Convert minutes to seconds
        let quizStarted = false;

        // Start the quiz
        function startQuiz() {
            document.getElementById('welcome-screen').style.display = 'none';
            document.getElementById('quiz-interface').style.display = 'block';
            quizStarted = true;
            startTimer();
            showQuestion(currentQuestionIndex);
            updateProgressBar();
            updateNavigationButtons();
        }

        // Timer functions
        function startTimer() {
            updateTimerDisplay();
            timer = setInterval(function() {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    submitQuiz();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const hours = Math.floor(timeLeft / 3600);
            const minutes = Math.floor((timeLeft % 3600) / 60);
            const seconds = timeLeft % 60;
            
            document.getElementById('time-display').textContent = 
                \`\${hours.toString().padStart(2, '0')}:\${minutes.toString().padStart(2, '0')}:\${seconds.toString().padStart(2, '0')}\`;
        }

        // Question navigation
        function showQuestion(index) {
            const quizContent = document.getElementById('quiz-content');
            const question = questions[index];
            
            document.getElementById('question-count').textContent = \`Question \${index + 1}/\${questions.length}\`;
            
            let optionsHtml = '';
            question.options.forEach((option, optionIndex) => {
                const isSelected = userAnswers[index] === (optionIndex + 1).toString();
                const optionLetter = String.fromCharCode(65 + optionIndex);
                optionsHtml += \`
                    <li class="option \${isSelected ? 'selected' : ''}" onclick="selectOption(\${optionIndex + 1})">
                        \${optionLetter}) \${option}
                    </li>
                \`;
            });
            
            quizContent.innerHTML = \`
                <div class="question">
                    <div class="question-text">\${question.text}</div>
                    <ul class="options">\${optionsHtml}</ul>
                </div>
            \`;
            
            updateNavigationButtons();
        }

        function selectOption(optionIndex) {
            userAnswers[currentQuestionIndex] = optionIndex.toString();
            showQuestion(currentQuestionIndex);
            
            // Show submit button if all questions are answered
            const allAnswered = userAnswers.every(answer => answer !== null);
            if (allAnswered) {
                document.getElementById('submit-btn').style.display = 'inline-block';
            }
        }

        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion(currentQuestionIndex);
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion(currentQuestionIndex);
            }
        }

        function updateNavigationButtons() {
            document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
            document.getElementById('next-btn').disabled = currentQuestionIndex === questions.length - 1;
        }

        function updateProgressBar() {
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = \`\${progress}%\`;
        }

        // Quiz submission and results
        function submitQuiz() {
            clearInterval(timer);
            document.getElementById('quiz-interface').style.display = 'none';
            document.getElementById('result-container').style.display = 'block';
            
            calculateResults();
        }

        function calculateResults() {
            let correctCount = 0;
            let incorrectCount = 0;
            let skippedCount = 0;
            
            // Calculate scores
            questions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                
                if (userAnswer === null) {
                    skippedCount++;
                } else if (userAnswer === question.correct_option) {
                    correctCount++;
                } else {
                    incorrectCount++;
                }
            });
            
            // Update UI with results
            document.getElementById('correct-count').textContent = correctCount;
            document.getElementById('incorrect-count').textContent = incorrectCount;
            document.getElementById('skipped-count').textContent = skippedCount;
            
            const score = correctCount;
            document.getElementById('score').textContent = \`\${score}/\${examInfo.test_total_marks}\`;
            
            // Set performance message
            const percentage = (correctCount / questions.length) * 100;
            let message = '';
            if (percentage >= 80) {
                message = 'Excellent! You have a great understanding of the subject.';
            } else if (percentage >= 60) {
                message = 'Good job! You have a solid understanding of the subject.';
            } else if (percentage >= 40) {
                message = 'Not bad! Keep practicing to improve your score.';
            } else {
                message = 'Keep studying! You can improve with more practice.';
            }
            document.getElementById('result-message').textContent = message;
            
            // Show detailed results
            showDetailedResults();
        }

        function showDetailedResults() {
            const detailedQuestions = document.getElementById('detailed-questions');
            let html = '';
            
            questions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.correct_option;
                const isSkipped = userAnswer === null;
                
                let statusClass = '';
                let statusText = '';
                
                if (isSkipped) {
                    statusClass = 'status-skipped';
                    statusText = 'Skipped';
                } else if (isCorrect) {
                    statusClass = 'status-correct';
                    statusText = 'Correct';
                } else {
                    statusClass = 'status-incorrect';
                    statusText = 'Incorrect';
                }
                
                let userAnswerText = 'Not answered';
                if (userAnswer !== null) {
                    const optionLetter = String.fromCharCode(64 + parseInt(userAnswer));
                    userAnswerText = \`\${optionLetter}) \${question.options[parseInt(userAnswer) - 1]}\`;
                }
                
                const correctOptionLetter = String.fromCharCode(64 + parseInt(question.correct_option));
                const correctAnswerText = \`\${correctOptionLetter}) \${question.options[parseInt(question.correct_option) - 1]}\`;
                
                html += \`
                    <div class="result-question">
                        <div class="result-question-text">
                            \${question.text}
                            <span class="result-status \${statusClass}">\${statusText}</span>
                        </div>
                        <div class="answer-section user-answer">
                            <strong>Your Answer:</strong> \${userAnswerText}
                        </div>
                        <div class="answer-section correct-answer">
                            <strong>Correct Answer:</strong> \${correctAnswerText}
                        </div>
                        <div class="solution">
                            <strong>Solution:</strong> \${question.solution}
                        </div>
                    </div>
                \`;
            });
            
            detailedQuestions.innerHTML = html;
        }

        function restartQuiz() {
            currentQuestionIndex = 0;
            userAnswers = new Array(questions.length).fill(null);
            timeLeft = parseInt(examInfo.test_duration) * 60;
            quizStarted = false;
            
            document.getElementById('result-container').style.display = 'none';
            document.getElementById('welcome-screen').style.display = 'block';
            document.getElementById('submit-btn').style.display = 'none';
        }
    </script>
</body>
</html>`;
        }
        
        function downloadHTML() {
            const htmlCode = document.getElementById('preview').dataset.htmlCode;
            const blob = new Blob([htmlCode], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'quiz-test.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function copyHTML() {
            const htmlCode = document.getElementById('preview').dataset.htmlCode;
            navigator.clipboard.writeText(htmlCode)
                .then(() => {
                    alert('HTML code copied to clipboard!');
                })
                .catch(err => {
                    console.error('Failed to copy: ', err);
                });
        }
    </script>
</body>
</html>